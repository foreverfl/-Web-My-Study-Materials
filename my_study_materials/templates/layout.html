{% load static %}
{% load socialaccount %} <!-- socialaccount 태그 라이브러리 로드 -->

<!DOCTYPE html>
<html>
  <head>
    <title>{% block title %}My Study Materials{% endblock %}</title>
    <!-- 모바일 반응형 디자인 설정 -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="{% block meta_description %}나만의 공부자료를 정리하고 공유하는 사이트{% endblock %}">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:title" content="My Study Materials">
    <meta property="og:description" content="나만의 공부자료를 정리하고 공유하는 사이트">
    <meta property="og:image" content="{% static 'images/noun-study.png' %}">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="{{ request.build_absolute_uri }}">
    <meta property="twitter:title" content="My Study Materials">
    <meta property="twitter:description" content="나만의 공부자료를 정리하고 공유하는 사이트">
    <meta property="twitter:image" content="{% static 'images/noun-study.png' %}">

    <link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">
    
    <!--CSS -->
    <link rel="stylesheet" href="{% static 'bootstrap-5.3.1-dist/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css'%}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/pygments.css' %}">

    <!-- Preventing Adblock-->
    <script async src="https://fundingchoicesmessages.google.com/i/pub-4751026650729929?ers=1" nonce="6cNOquR49qiT8ba6gaSveQ"></script><script nonce="6cNOquR49qiT8ba6gaSveQ">(function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();</script>
    <script>(function(){'use strict';function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var ba="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
    function ea(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var fa=ea(this);function ha(a,b){if(b)a:{var c=fa;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ba(c,a,{configurable:!0,writable:!0,value:b})}}
    var ia="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},l;if("function"==typeof Object.setPrototypeOf)l=Object.setPrototypeOf;else{var m;a:{var ja={a:!0},ka={};try{ka.__proto__=ja;m=ka.a;break a}catch(a){}m=!1}l=m?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var la=l;
    function n(a,b){a.prototype=ia(b.prototype);a.prototype.constructor=a;if(la)la(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.A=b.prototype}function ma(){for(var a=Number(this),b=[],c=a;c<arguments.length;c++)b[c-a]=arguments[c];return b}
    var na="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(a[e]=d[e])}return a};ha("Object.assign",function(a){return a||na});/*

    Copyright The Closure Library Authors.
    SPDX-License-Identifier: Apache-2.0
    */
    var p=this||self;function q(a){return a};var t,u;a:{for(var oa=["CLOSURE_FLAGS"],v=p,x=0;x<oa.length;x++)if(v=v[oa[x]],null==v){u=null;break a}u=v}var pa=u&&u[610401301];t=null!=pa?pa:!1;var z,qa=p.navigator;z=qa?qa.userAgentData||null:null;function A(a){return t?z?z.brands.some(function(b){return(b=b.brand)&&-1!=b.indexOf(a)}):!1:!1}function B(a){var b;a:{if(b=p.navigator)if(b=b.userAgent)break a;b=""}return-1!=b.indexOf(a)};function C(){return t?!!z&&0<z.brands.length:!1}function D(){return C()?A("Chromium"):(B("Chrome")||B("CriOS"))&&!(C()?0:B("Edge"))||B("Silk")};var ra=C()?!1:B("Trident")||B("MSIE");!B("Android")||D();D();B("Safari")&&(D()||(C()?0:B("Coast"))||(C()?0:B("Opera"))||(C()?0:B("Edge"))||(C()?A("Microsoft Edge"):B("Edg/"))||C()&&A("Opera"));var sa={},E=null;var ta="undefined"!==typeof Uint8Array,ua=!ra&&"function"===typeof btoa;var F="function"===typeof Symbol&&"symbol"===typeof Symbol()?Symbol():void 0,G=F?function(a,b){a[F]|=b}:function(a,b){void 0!==a.g?a.g|=b:Object.defineProperties(a,{g:{value:b,configurable:!0,writable:!0,enumerable:!1}})};function va(a){var b=H(a);1!==(b&1)&&(Object.isFrozen(a)&&(a=Array.prototype.slice.call(a)),I(a,b|1))}
    var H=F?function(a){return a[F]|0}:function(a){return a.g|0},J=F?function(a){return a[F]}:function(a){return a.g},I=F?function(a,b){a[F]=b}:function(a,b){void 0!==a.g?a.g=b:Object.defineProperties(a,{g:{value:b,configurable:!0,writable:!0,enumerable:!1}})};function wa(){var a=[];G(a,1);return a}function xa(a,b){I(b,(a|0)&-99)}function K(a,b){I(b,(a|34)&-73)}function L(a){a=a>>11&1023;return 0===a?536870912:a};var M={};function N(a){return null!==a&&"object"===typeof a&&!Array.isArray(a)&&a.constructor===Object}var O,ya=[];I(ya,39);O=Object.freeze(ya);var P;function Q(a,b){P=b;a=new a(b);P=void 0;return a}
    function R(a,b,c){null==a&&(a=P);P=void 0;if(null==a){var d=96;c?(a=[c],d|=512):a=[];b&&(d=d&-2095105|(b&1023)<<11)}else{if(!Array.isArray(a))throw Error();d=H(a);if(d&64)return a;d|=64;if(c&&(d|=512,c!==a[0]))throw Error();a:{c=a;var e=c.length;if(e){var f=e-1,g=c[f];if(N(g)){d|=256;b=(d>>9&1)-1;e=f-b;1024<=e&&(za(c,b,g),e=1023);d=d&-2095105|(e&1023)<<11;break a}}b&&(g=(d>>9&1)-1,b=Math.max(b,e-g),1024<b&&(za(c,g,{}),d|=256,b=1023),d=d&-2095105|(b&1023)<<11)}}I(a,d);return a}
    function za(a,b,c){for(var d=1023+b,e=a.length,f=d;f<e;f++){var g=a[f];null!=g&&g!==c&&(c[f-b]=g)}a.length=d+1;a[d]=c};function Aa(a){switch(typeof a){case "number":return isFinite(a)?a:String(a);case "boolean":return a?1:0;case "object":if(a&&!Array.isArray(a)&&ta&&null!=a&&a instanceof Uint8Array){if(ua){for(var b="",c=0,d=a.length-10240;c<d;)b+=String.fromCharCode.apply(null,a.subarray(c,c+=10240));b+=String.fromCharCode.apply(null,c?a.subarray(c):a);a=btoa(b)}else{void 0===b&&(b=0);if(!E){E={};c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split("");d=["+/=","+/","-_=","-_.","-_"];for(var e=
    0;5>e;e++){var f=c.concat(d[e].split(""));sa[e]=f;for(var g=0;g<f.length;g++){var h=f[g];void 0===E[h]&&(E[h]=g)}}}b=sa[b];c=Array(Math.floor(a.length/3));d=b[64]||"";for(e=f=0;f<a.length-2;f+=3){var k=a[f],w=a[f+1];h=a[f+2];g=b[k>>2];k=b[(k&3)<<4|w>>4];w=b[(w&15)<<2|h>>6];h=b[h&63];c[e++]=g+k+w+h}g=0;h=d;switch(a.length-f){case 2:g=a[f+1],h=b[(g&15)<<2]||d;case 1:a=a[f],c[e]=b[a>>2]+b[(a&3)<<4|g>>4]+h+d}a=c.join("")}return a}}return a};function Ba(a,b,c){a=Array.prototype.slice.call(a);var d=a.length,e=b&256?a[d-1]:void 0;d+=e?-1:0;for(b=b&512?1:0;b<d;b++)a[b]=c(a[b]);if(e){b=a[b]={};for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(b[f]=c(e[f]))}return a}function Da(a,b,c,d,e,f){if(null!=a){if(Array.isArray(a))a=e&&0==a.length&&H(a)&1?void 0:f&&H(a)&2?a:Ea(a,b,c,void 0!==d,e,f);else if(N(a)){var g={},h;for(h in a)Object.prototype.hasOwnProperty.call(a,h)&&(g[h]=Da(a[h],b,c,d,e,f));a=g}else a=b(a,d);return a}}
    function Ea(a,b,c,d,e,f){var g=d||c?H(a):0;d=d?!!(g&32):void 0;a=Array.prototype.slice.call(a);for(var h=0;h<a.length;h++)a[h]=Da(a[h],b,c,d,e,f);c&&c(g,a);return a}function Fa(a){return a.s===M?a.toJSON():Aa(a)};function Ga(a,b,c){c=void 0===c?K:c;if(null!=a){if(ta&&a instanceof Uint8Array)return b?a:new Uint8Array(a);if(Array.isArray(a)){var d=H(a);if(d&2)return a;if(b&&!(d&64)&&(d&32||0===d))return I(a,d|34),a;a=Ea(a,Ga,d&4?K:c,!0,!1,!0);b=H(a);b&4&&b&2&&Object.freeze(a);return a}a.s===M&&(b=a.h,c=J(b),a=c&2?a:Q(a.constructor,Ha(b,c,!0)));return a}}function Ha(a,b,c){var d=c||b&2?K:xa,e=!!(b&32);a=Ba(a,b,function(f){return Ga(f,e,d)});G(a,32|(c?2:0));return a};function Ia(a,b){a=a.h;return Ja(a,J(a),b)}function Ja(a,b,c,d){if(-1===c)return null;if(c>=L(b)){if(b&256)return a[a.length-1][c]}else{var e=a.length;if(d&&b&256&&(d=a[e-1][c],null!=d))return d;b=c+((b>>9&1)-1);if(b<e)return a[b]}}function Ka(a,b,c,d,e){var f=L(b);if(c>=f||e){e=b;if(b&256)f=a[a.length-1];else{if(null==d)return;f=a[f+((b>>9&1)-1)]={};e|=256}f[c]=d;e&=-1025;e!==b&&I(a,e)}else a[c+((b>>9&1)-1)]=d,b&256&&(d=a[a.length-1],c in d&&delete d[c]),b&1024&&I(a,b&-1025)}
    function La(a,b){var c=Ma;var d=void 0===d?!1:d;var e=a.h;var f=J(e),g=Ja(e,f,b,d);var h=!1;if(null==g||"object"!==typeof g||(h=Array.isArray(g))||g.s!==M)if(h){var k=h=H(g);0===k&&(k|=f&32);k|=f&2;k!==h&&I(g,k);c=new c(g)}else c=void 0;else c=g;c!==g&&null!=c&&Ka(e,f,b,c,d);e=c;if(null==e)return e;a=a.h;f=J(a);f&2||(g=e,c=g.h,h=J(c),g=h&2?Q(g.constructor,Ha(c,h,!1)):g,g!==e&&(e=g,Ka(a,f,b,e,d)));return e}function Na(a,b){a=Ia(a,b);return null==a||"string"===typeof a?a:void 0}
    function Oa(a,b){a=Ia(a,b);return null!=a?a:0}function S(a,b){a=Na(a,b);return null!=a?a:""};function T(a,b,c){this.h=R(a,b,c)}T.prototype.toJSON=function(){var a=Ea(this.h,Fa,void 0,void 0,!1,!1);return Pa(this,a,!0)};T.prototype.s=M;T.prototype.toString=function(){return Pa(this,this.h,!1).toString()};
    function Pa(a,b,c){var d=a.constructor.v,e=L(J(c?a.h:b)),f=!1;if(d){if(!c){b=Array.prototype.slice.call(b);var g;if(b.length&&N(g=b[b.length-1]))for(f=0;f<d.length;f++)if(d[f]>=e){Object.assign(b[b.length-1]={},g);break}f=!0}e=b;c=!c;g=J(a.h);a=L(g);g=(g>>9&1)-1;for(var h,k,w=0;w<d.length;w++)if(k=d[w],k<a){k+=g;var r=e[k];null==r?e[k]=c?O:wa():c&&r!==O&&va(r)}else h||(r=void 0,e.length&&N(r=e[e.length-1])?h=r:e.push(h={})),r=h[k],null==h[k]?h[k]=c?O:wa():c&&r!==O&&va(r)}d=b.length;if(!d)return b;
    var Ca;if(N(h=b[d-1])){a:{var y=h;e={};c=!1;for(var ca in y)Object.prototype.hasOwnProperty.call(y,ca)&&(a=y[ca],Array.isArray(a)&&a!=a&&(c=!0),null!=a?e[ca]=a:c=!0);if(c){for(var rb in e){y=e;break a}y=null}}y!=h&&(Ca=!0);d--}for(;0<d;d--){h=b[d-1];if(null!=h)break;var cb=!0}if(!Ca&&!cb)return b;var da;f?da=b:da=Array.prototype.slice.call(b,0,d);b=da;f&&(b.length=d);y&&b.push(y);return b};function Qa(a){return function(b){if(null==b||""==b)b=new a;else{b=JSON.parse(b);if(!Array.isArray(b))throw Error(void 0);G(b,32);b=Q(a,b)}return b}};function Ra(a){this.h=R(a)}n(Ra,T);var Sa=Qa(Ra);var U;function V(a){this.g=a}V.prototype.toString=function(){return this.g+""};var Ta={};function Ua(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)};function Va(a,b){b=String(b);"application/xhtml+xml"===a.contentType&&(b=b.toLowerCase());return a.createElement(b)}function Wa(a){this.g=a||p.document||document}Wa.prototype.appendChild=function(a,b){a.appendChild(b)};/*

    SPDX-License-Identifier: Apache-2.0
    */
    function Xa(a,b){a.src=b instanceof V&&b.constructor===V?b.g:"type_error:TrustedResourceUrl";var c,d;(c=(b=null==(d=(c=(a.ownerDocument&&a.ownerDocument.defaultView||window).document).querySelector)?void 0:d.call(c,"script[nonce]"))?b.nonce||b.getAttribute("nonce")||"":"")&&a.setAttribute("nonce",c)};function Ya(a){a=void 0===a?document:a;return a.createElement("script")};function Za(a,b,c,d,e,f){try{var g=a.g,h=Ya(g);h.async=!0;Xa(h,b);g.head.appendChild(h);h.addEventListener("load",function(){e();d&&g.head.removeChild(h)});h.addEventListener("error",function(){0<c?Za(a,b,c-1,d,e,f):(d&&g.head.removeChild(h),f())})}catch(k){f()}};var $a=p.atob("aHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vaW1hZ2VzL2ljb25zL21hdGVyaWFsL3N5c3RlbS8xeC93YXJuaW5nX2FtYmVyXzI0ZHAucG5n"),ab=p.atob("WW91IGFyZSBzZWVpbmcgdGhpcyBtZXNzYWdlIGJlY2F1c2UgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlIGlzIGludGVyZmVyaW5nIHdpdGggdGhpcyBwYWdlLg=="),bb=p.atob("RGlzYWJsZSBhbnkgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlLCB0aGVuIHJlbG9hZCB0aGlzIHBhZ2Uu");function db(a,b,c){this.i=a;this.l=new Wa(this.i);this.g=null;this.j=[];this.m=!1;this.u=b;this.o=c}
    function eb(a){if(a.i.body&&!a.m){var b=function(){fb(a);p.setTimeout(function(){return gb(a,3)},50)};Za(a.l,a.u,2,!0,function(){p[a.o]||b()},b);a.m=!0}}
    function fb(a){for(var b=W(1,5),c=0;c<b;c++){var d=X(a);a.i.body.appendChild(d);a.j.push(d)}b=X(a);b.style.bottom="0";b.style.left="0";b.style.position="fixed";b.style.width=W(100,110).toString()+"%";b.style.zIndex=W(2147483544,2147483644).toString();b.style["background-color"]=hb(249,259,242,252,219,229);b.style["box-shadow"]="0 0 12px #888";b.style.color=hb(0,10,0,10,0,10);b.style.display="flex";b.style["justify-content"]="center";b.style["font-family"]="Roboto, Arial";c=X(a);c.style.width=W(80,
    85).toString()+"%";c.style.maxWidth=W(750,775).toString()+"px";c.style.margin="24px";c.style.display="flex";c.style["align-items"]="flex-start";c.style["justify-content"]="center";d=Va(a.l.g,"IMG");d.className=Ua();d.src=$a;d.alt="Warning icon";d.style.height="24px";d.style.width="24px";d.style["padding-right"]="16px";var e=X(a),f=X(a);f.style["font-weight"]="bold";f.textContent=ab;var g=X(a);g.textContent=bb;Y(a,e,f);Y(a,e,g);Y(a,c,d);Y(a,c,e);Y(a,b,c);a.g=b;a.i.body.appendChild(a.g);b=W(1,5);for(c=
    0;c<b;c++)d=X(a),a.i.body.appendChild(d),a.j.push(d)}function Y(a,b,c){for(var d=W(1,5),e=0;e<d;e++){var f=X(a);b.appendChild(f)}b.appendChild(c);c=W(1,5);for(d=0;d<c;d++)e=X(a),b.appendChild(e)}function W(a,b){return Math.floor(a+Math.random()*(b-a))}function hb(a,b,c,d,e,f){return"rgb("+W(Math.max(a,0),Math.min(b,255)).toString()+","+W(Math.max(c,0),Math.min(d,255)).toString()+","+W(Math.max(e,0),Math.min(f,255)).toString()+")"}function X(a){a=Va(a.l.g,"DIV");a.className=Ua();return a}
    function gb(a,b){0>=b||null!=a.g&&0!=a.g.offsetHeight&&0!=a.g.offsetWidth||(ib(a),fb(a),p.setTimeout(function(){return gb(a,b-1)},50))}
    function ib(a){var b=a.j;var c="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];if(c)b=c.call(b);else if("number"==typeof b.length)b={next:aa(b)};else throw Error(String(b)+" is not an iterable or ArrayLike");for(c=b.next();!c.done;c=b.next())(c=c.value)&&c.parentNode&&c.parentNode.removeChild(c);a.j=[];(b=a.g)&&b.parentNode&&b.parentNode.removeChild(b);a.g=null};function jb(a,b,c,d,e){function f(k){document.body?g(document.body):0<k?p.setTimeout(function(){f(k-1)},e):b()}function g(k){k.appendChild(h);p.setTimeout(function(){h?(0!==h.offsetHeight&&0!==h.offsetWidth?b():a(),h.parentNode&&h.parentNode.removeChild(h)):a()},d)}var h=kb(c);f(3)}function kb(a){var b=document.createElement("div");b.className=a;b.style.width="1px";b.style.height="1px";b.style.position="absolute";b.style.left="-10000px";b.style.top="-10000px";b.style.zIndex="-10000";return b};function Ma(a){this.h=R(a)}n(Ma,T);function lb(a){this.h=R(a)}n(lb,T);var mb=Qa(lb);function nb(a){a=Na(a,4)||"";if(void 0===U){var b=null;var c=p.trustedTypes;if(c&&c.createPolicy){try{b=c.createPolicy("goog#html",{createHTML:q,createScript:q,createScriptURL:q})}catch(d){p.console&&p.console.error(d.message)}U=b}else U=b}a=(b=U)?b.createScriptURL(a):a;return new V(a,Ta)};function ob(a,b){this.m=a;this.o=new Wa(a.document);this.g=b;this.j=S(this.g,1);this.u=nb(La(this.g,2));this.i=!1;b=nb(La(this.g,13));this.l=new db(a.document,b,S(this.g,12))}ob.prototype.start=function(){pb(this)};
    function pb(a){qb(a);Za(a.o,a.u,3,!1,function(){a:{var b=a.j;var c=p.btoa(b);if(c=p[c]){try{var d=Sa(p.atob(c))}catch(e){b=!1;break a}b=b===Na(d,1)}else b=!1}b?Z(a,S(a.g,14)):(Z(a,S(a.g,8)),eb(a.l))},function(){jb(function(){Z(a,S(a.g,7));eb(a.l)},function(){return Z(a,S(a.g,6))},S(a.g,9),Oa(a.g,10),Oa(a.g,11))})}function Z(a,b){a.i||(a.i=!0,a=new a.m.XMLHttpRequest,a.open("GET",b,!0),a.send())}function qb(a){var b=p.btoa(a.j);a.m[b]&&Z(a,S(a.g,5))};(function(a,b){p[a]=function(){var c=ma.apply(0,arguments);p[a]=function(){};b.apply(null,c)}})("__h82AlnkH6D91__",function(a){"function"===typeof window.atob&&(new ob(window,mb(window.atob(a)))).start()});}).call(this);

    window.__h82AlnkH6D91__("WyJwdWItNDc1MTAyNjY1MDcyOTkyOSIsW251bGwsbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9iL3B1Yi00NzUxMDI2NjUwNzI5OTI5Il0sbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9lbC9BR1NLV3hXbGhRUFowcnBUbFN6Ui0xNDRCeXNkaUx1SmZwdnlUSzhxVzBrX0R6dXVIZ2VFaWtHNjF0LTVpUDM5Rmt2M01jdFUyQ3hQUlZBSzRORVhxVm84U1BPTVpnXHUwMDNkXHUwMDNkP3RlXHUwMDNkVE9LRU5fRVhQT1NFRCIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFVpaTZBMmlLY1VUMFZjdnpxbXZKLU1YV2dzeW5rb3J1Q2FoczktU3J3ejRTUWpUUHZxUkNyV3NTVnNaQ2x2cy1nWVRoTlZwSExzQU5icUtJaGlaS2tLdndcdTAwM2RcdTAwM2Q/YWJcdTAwM2QxXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFZjQUk0WFJPc2RDTjJOelN1cXViQk5ZWHVhMVg5Q29uZmdlVk1xaUZEbEIzVjh3X1Q5Yl8td1V1WkdESkFtSGNNelRZd2I5NzNKOVkzanlEUUtIbDZlZ2dcdTAwM2RcdTAwM2Q/YWJcdTAwM2QyXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFdQc2dHYThYcy13X0ExdkNyZUd4b1dHV3h1SDcteG1XU0h1U1RXb05rdjI1MzFaUDE0djB6R3pLdFBjWHFva1g0aFdqWmZzNnVDQ2RGdkR2Z0ZIQkNvQ3dcdTAwM2RcdTAwM2Q/c2JmXHUwMDNkMiIsImRpdi1ncHQtYWQiLDIwLDEwMCwiY0hWaUxUUTNOVEV3TWpZMk5UQTNNams1TWprXHUwMDNkIixbbnVsbCxudWxsLG51bGwsImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tLzBlbW4vZi9wL3B1Yi00NzUxMDI2NjUwNzI5OTI5LmpzP3VzcXBcdTAwM2RDQkUiXSwiaHR0cHM6Ly9mdW5kaW5nY2hvaWNlc21lc3NhZ2VzLmdvb2dsZS5jb20vZWwvQUdTS1d4VXViMFR3NVVoU0V1S2lrTzRzSF9sQThkSGtDQVg3cGt6dk9rVHJHSkxScU1veWpGc0JrQlRnRTBqemdVSXRvSk9YRjhRZF9rdDRWOHNNQU1FMndYck1Nd1x1MDAzZFx1MDAzZCJd");</script>
  </head>
  
  <body>
    <!-- Mobile -->
    <div class="d-flex justify-content-between align-items-center">
      <!-- Search & Sidebar -->
      <button class="btn d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar-button" aria-controls="sidebar-button">
        <img src="{% static 'bootstrap-icons-1.10.5/list.svg'%}" alt="menu" width="30" height="30" />
      </button>

      <!-- Profile -->
      <div class="navbar-nav ml-auto pe-3 d-lg-none">
        <div class="nav-item dropdown position-relative">
          <a class="nav-link" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <img src="{% static 'bootstrap-icons-1.10.5/person-circle.svg'%}" alt="person" width="30" height="30" />
          </a>
          <div class="dropdown-menu dropdown-menu-end position-absolute" style="top: 100%; right: 0;" aria-labelledby="navbarDropdown">
              {% if user.is_authenticated %}
                <p class="dropdown-item text-center disabled">{{ user.last_name }} {{ user.first_name }}님 환영합니다!</p>
                
                {% if user.is_staff %}
                <p class="dropdown-item text-center disabled">관리자</p>
                {% elif subscription.is_subscribed %}
                <p class="dropdown-item text-center disabled">유료회원</p>
                {% else %}
                <p class="dropdown-item text-center disabled">무료회원</p>
              {% endif %}

              {% if not subscription.is_subscribed %}
                <a class="dropdown-item text-center" href="{% url 'payment_describe' %}">구독하기</a>
                <hr>
              {% endif %}                
                <a class="dropdown-item text-center" href="{% url 'account_logout' %}">로그아웃</a>
              {% else %}
                <a class="dropdown-item text-center" href="{% url 'account_login' %}">로그인</a>
              {% endif %}
          </div>
        </div>
      </div>
    </div>

    <!-- Search -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebar-button" aria-labelledby="sidebar-button">
      <div class="offcanvas-header">
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <!-- Search Bar -->
        <div>
          <div class="d-flex justify-content-center my-5"> 
            <form class="row g-3" action="{% url 'search' %}" method="get">
              <div class="col-auto">
                <input
                  class="form-control mr-sm-2"
                  type="text"
                  name="q"
                  value="{{ request.GET.q }}"
                  placeholder="Search"
                  aria-label="Search"
                />
              </div>
              <div class="col-auto">
                <button class="btn btn-outline-primary my-sm-0" type="submit">
                  <img
                    src="{% static 'bootstrap-icons-1.10.5/search.svg'%}"
                    alt="search"
                    width="15"
                    height="15"
                  />
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Left sidebar -->
        <div>
          <div class="sidebar-sticky">
            <ul class="nav flex-column gap-3">
              <!-- CRUD -->
              {% if user.is_authenticated %}
              <p id="category-settings" class="fw-bold d-flex justify-content-center" data-bs-toggle="collapse" data-bs-target="#categoryButtons">My Categories Settings
                <img id="category-caret-icon" class="align-self-center ms-2" src="{% static 'bootstrap-icons-1.10.5/caret-down-fill.svg'%}" alt="caret-down-fill" width="10" height="10" />                   
              </p>
              <div class="collapse" id="categoryButtons">
                <li class="nav-item rounded d-flex flex-xl-row flex-md-column justify-content-center gap-3">            
                  <a class="btn btn-sm btn-outline-primary" href="#" data-bs-toggle="modal" data-bs-target="#create-category-modal">추가</a>
                  <a class="btn btn-sm btn-outline-secondary" href="#" id="update-category-btn-mobile">수정</a>
                  <a class="btn btn-sm btn-outline-danger" href="#" id="delete-category-btn-mobile">삭제</a>
                </li>
              </div>
              <hr>
              {% endif %}

              <!-- User Category -->
              <p class="fw-bold d-flex justify-content-center">My Categories</p>
              {% if user.is_authenticated %}                
                {% for category in current_user_categories %}
                <li class="sidebar-category nav-item rounded d-flex justify-content-center">
                    <a class="nav-link" href="{% url 'category_detail' category.id %}">{{ category.name }}</a>
                    <button class="btn btn-sm btn-danger delete-category-sub-btn-mobile" data-category-id="{{ category.id }}" style="display: none;">삭제</button>
                    <button class="btn btn-sm btn-secondary update-category-sub-btn-mobile" data-category-id="{{ category.id }}" style="display: none;">수정</button>
                </li>
                {% endfor %}
              {% endif %}

              <hr>

              <!-- Added Categories (default: Admin Category)-->
              <p class="fw-bold d-flex justify-content-center">Added Categories</p>
              {% if user.is_authenticated %}
                  {% for category in subscribed_categories %}
                  <li class="sidebar-category nav-item rounded d-flex justify-content-center">
                      <a class="nav-link" href="{% url 'category_detail' category.id %}">{{ category.name }}</a>
                  </li>
                  {% endfor %}
              {% else %}
                  {% for category in admin_categories %}
                  <li class="sidebar-category nav-item rounded d-flex justify-content-center">
                      <a class="nav-link" href="{% url 'category_detail' category.id %}">{{ category.name }}</a>
                  </li>
                  {% endfor %}
              {% endif %}

              <hr>

              <!-- Others -->
              <li class="sidebar-category nav-item rounded d-flex justify-content-center">
                  <!-- All Categories -->
                  <a class="nav-link fw-bold text-decoration-none text-dark" href="{% url 'category_list' %}">All Categories</a>
              </li>
              
            </ul>
          </div>
        </div>                   
      </div>
    </div>

    <!-- Desktop -->
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg pt-4 d-none d-lg-block">
      <div class="container-fluid">
        <!-- Logo -->
        <a class="navbar-brand ps-5" href="/">My Study<br>Materials</a>

        <!-- Search Bar -->
        <form class="row g-3" action="{% url 'search' %}" method="get">
          <div class="col-auto">
            <input
              class="form-control mr-sm-2"
              type="text"
              name="q"
              value="{{ request.GET.q }}"
              placeholder="Search"
              aria-label="Search"
            />
          </div>
          <div class="col-auto">
            <button class="btn btn-outline-primary my-2 my-sm-0" type="submit">
              <img
                src="{% static 'bootstrap-icons-1.10.5/search.svg'%}"
                alt="search"
                width="15"
                height="15"
              />
            </button>
          </div>
        </form>

        <!-- Profile -->
        <div class="navbar-nav ml-auto pe-3">
          <div class="nav-item dropdown position-relative">
            <a class="nav-link" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <img src="{% static 'bootstrap-icons-1.10.5/person-circle.svg'%}" alt="person" width="30" height="30" />
            </a>
            <div class="dropdown-menu dropdown-menu-end position-absolute" style="top: 100%; right: 0;" aria-labelledby="navbarDropdown">
              {% if user.is_authenticated %}
                <p class="dropdown-item text-center disabled">{{ user.last_name }} {{ user.first_name }}님 환영합니다!</p>
                
                {% if user.is_staff %}
                  <p class="dropdown-item text-center disabled">관리자</p>
                {% elif subscription.is_subscribed %}
                  <p class="dropdown-item text-center disabled">유료회원</p>
                {% else %}
                  <p class="dropdown-item text-center disabled">무료회원</p>
                {% endif %}

                {% if not subscription.is_subscribed %}
                  <a class="dropdown-item text-center" href="{% url 'payment_describe' %}">구독하기</a>
                  <hr>
                {% endif %}
                
                <a class="dropdown-item text-center" href="{% url 'account_logout' %}">로그아웃</a>
              {% else %}
                <a class="dropdown-item text-center" href="{% url 'account_login' %}">로그인</a>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </nav>
    
    <div class="container-fluid min-vh-100 d-flex flex-column">
      <div class="row flex-grow-1">
        <!-- Left sidebar -->
        <div class="col-xl-2 col-md-2 d-none d-md-block sidebar py-5">
          <div class="sidebar-sticky">
            <ul class="nav flex-column gap-3">
              <!-- CRUD -->
              {% if user.is_authenticated %}
              <p id="category-settings" class="fw-bold d-flex justify-content-center" data-bs-toggle="collapse" data-bs-target="#categoryButtons">My Categories Settings
                <img id="category-caret-icon" class="align-self-center ms-2" src="{% static 'bootstrap-icons-1.10.5/caret-down-fill.svg'%}" alt="caret-down-fill" width="10" height="10" />                   
              </p>
              <div class="collapse" id="categoryButtons">
                <li class="nav-item rounded d-flex flex-xl-row flex-md-column justify-content-center gap-3">            
                  <a class="btn btn-sm btn-outline-primary" href="#" data-bs-toggle="modal" data-bs-target="#create-category-modal">추가</a>
                  <a class="btn btn-sm btn-outline-secondary" href="#" id="update-category-btn">수정</a>
                  <a class="btn btn-sm btn-outline-danger" href="#" id="delete-category-btn">삭제</a>
                </li>
              </div>
              <hr>
              {% endif %}

              <!-- User Category -->
              <p class="fw-bold d-flex justify-content-center">My Categories</p>
              {% if user.is_authenticated %}                
                {% for category in current_user_categories %}
                <li class="sidebar-category nav-item rounded d-flex justify-content-center">
                    <a class="nav-link" href="{% url 'category_detail' category.id %}">{{ category.name }}</a>
                    <button class="btn btn-sm btn-danger delete-category-sub-btn" data-category-id="{{ category.id }}" style="display: none;">삭제</button>
                    <button class="btn btn-sm btn-secondary update-category-sub-btn" data-category-id="{{ category.id }}" style="display: none;">수정</button>
                </li>
                {% endfor %}
              {% endif %}

              <hr>

              <!-- Added Categories (default: Admin Category)-->
              <p class="fw-bold d-flex justify-content-center">Added Categories</p>
              {% if user.is_authenticated %}
                  {% for category in subscribed_categories %}
                  <li class="sidebar-category nav-item rounded d-flex justify-content-center">
                      <a class="nav-link" href="{% url 'category_detail' category.id %}">{{ category.name }}</a>
                  </li>
                  {% endfor %}
              {% else %}
                  {% for category in admin_categories %}
                  <li class="sidebar-category nav-item rounded d-flex justify-content-center">
                      <a class="nav-link" href="{% url 'category_detail' category.id %}">{{ category.name }}</a>
                  </li>
                  {% endfor %}
              {% endif %}

              <hr>

              <!-- Others -->
              <li class="sidebar-category nav-item rounded d-flex justify-content-center">
                  <!-- All Categories -->
                  <a class="nav-link fw-bold text-decoration-none text-dark" href="{% url 'category_list' %}">All Categories</a>
              </li>
              
            </ul>
          </div>
        </div>

        <!-- Content -->
        <div class="col-xl-8 col-md-10 col-12">
            {% block content %}{% endblock %}
        </div>

        <!-- Right sidebar (Desktop version) -->
        <!-- d-xl-flex: xl 화면 크기에서만 flexbox 컨테이너로 만듦-->
        <div class="col-xl-2 d-none d-xl-flex justify-content-center align-items-center position-fixed" style="height:80vh; right: 0">
          <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4751026650729929"
              crossorigin="anonymous"></script>
          <!-- vertical -->
          <ins class="adsbygoogle"
              style="display:inline-block;width:160px;height:600px"
              data-ad-client="ca-pub-4751026650729929"
              data-ad-slot="4768114162"></ins>
          <script>
              (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>

        <!-- Right sidebar (Mobile and Tablet version) -->
        <div class="d-none col-12 justify-content-center align-items-center">
          
        </div>

      </div>
    </div>

    <!-- footer -->
    <footer class="bg-light text-muted" id="footer">
      <div class="container-fluid px-5 py-4">
        <div class="d-flex flex-column flex-md-row align-items-center justify-content-center justify-content-md-between">
          <p class="mb-2 mb-md-0 text-center" style="font-size: 12px;">
            대표이사: MYEONGKYU JEON | 상호: My Dictionary | 사업자등록번호: 619-09-28407 | 이메일: forever_fl@naver.com 
          </p>
          <p class="mb-0 text-center" style="font-size: 12px;">Copyright © 2023 All rights reserved.</p>
        </div>
      </div>
    </footer>

  <!-- Modal -->
  <!-- Create Category Modal -->
  <div class="modal fade" id="create-category-modal" tabindex="-1" role="dialog" aria-labelledby="category-create-modal" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">카테고리 추가</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="create-category-form">
            <!-- 공개/비공개 드롭다운 -->
            <div class="form-group d-flex justify-content-end mb-3">
              <select id="create-category-is-public" name="is_public" class="form-control w-auto">
                <option value="true">공개</option>
                <option value="false">비공개</option>
              </select>
            </div>
            <!-- 제목 -->
            <div class="form-group mb-3">
              <input type="text" class="form-control" id="create-category-name" name="name" placeholder="카테고리명">
            </div>
            <!-- 설명 텍스트 필드 -->
            <div class="form-group mb-3">
              <textarea class="form-control" id="create-category-description" name="description" placeholder="설명" rows="10"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
          <button type="button" class="btn btn-primary" id="create-category-btn-modal">추가하기</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Update Category Modal -->
  <div class="modal fade" id="update-create-modal" tabindex="-1" role="dialog" aria-labelledby="update-create-modal" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">카테고리 수정</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="update-category-form">
            <!-- 공개/비공개 드롭다운 -->
            <div class="form-group d-flex justify-content-end mb-3">
              <select id="update-category-is-public" name="is_public" class="form-control w-auto">
                <option value="true">공개</option>
                <option value="false">비공개</option>
              </select>
            </div>
            <!-- 제목 -->
            <div class="form-group mb-3">
              <input type="text" class="form-control" id="update-category-name" name="name" placeholder="카테고리명">
            </div>
            <!-- 설명 텍스트 필드 -->
            <div class="form-group mb-3">
              <textarea class="form-control" id="update-category-description" name="description" placeholder="설명" rows="10"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
          <button type="button" class="btn btn-primary" id="update-category-btn-modal">수정하기</button>
        </div>
      </div>
    </div>
  </div>

  </body>

  <!-- Bootstrap JS -->
  <script src="{% static 'bootstrap-5.3.1-dist/js/bootstrap.bundle.min.js' %}"></script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4751026650729929"
    crossorigin="anonymous"></script>
  <script>
    const currentUserCategories = {{ current_user_categories_json|safe }};
    const isAuthenticated = {{ user.is_authenticated|yesno:"true,false" }};

    if(isAuthenticated) {
      // 카테고리 추가 및 수정
      document.addEventListener('DOMContentLoaded', function(){
        
        // 카테고리 추가
        document.querySelector("#create-category-btn-modal").addEventListener('click', function(){
          var formElement = document.querySelector("#create-category-form");
          var formData = new FormData(formElement);
          
          for (var pair of formData.entries()) {
            console.log(pair[0] + ', ' + pair[1]); 
          }
      
          fetch("{% url 'category_create' %}", { // Django에서 지정한 URL을 가져옴
            method: 'POST',
            body: formData,
            headers: {
              'X-CSRFToken': '{{ csrf_token }}', 
            },
          })
          .then(response => {
            if (!response.ok) {
              return response.json().then(json => {
                if (json.errors === "Maximum number of categories reached") {
                  alert("최대 카테고리 개수를 초과했습니다.");
                } else if (json.errors === "Category name already exists") {
                  alert("이미 존재하는 카테고리 이름입니다.");
                } else {
                  alert(json.errors || "카테고리를 추가하는 도중 오류가 발생했습니다. 다시 시도해 주세요.");
                }
                throw new Error(`HTTP error! status: ${response.status}`);
              });
            } 
            return response.json();
          })
          .then(json => {
            location.reload();
          })
          .catch((error) => {
            console.log('Error:', error);
          });
        });


        // 카테고리 수정
        document.querySelector("#update-category-btn-modal").addEventListener('click', function(){
          var formElement = document.querySelector("#update-category-form");
          var formData = new FormData(formElement);
          var categoryId = formElement.getAttribute("data-category-id");
          var updateUrl = "{% url 'category_update' category_id=0 %}".replace('0', categoryId);

          fetch(updateUrl, { // Django에서 지정한 URL을 가져옴
            method: 'POST',
            body: formData,
            headers: {
              'X-CSRFToken': '{{ csrf_token }}',
            },
          })
          .then(response => {
            if (!response.ok) {
              return response.json().then(json => {
                if (json.errors === "Category name already exists") {
                  alert("이미 존재하는 카테고리 이름입니다.");
                } else {
                  alert(json.errors || "카테고리를 수정하는 도중 오류가 발생했습니다. 다시 시도해 주세요.");
                }
                throw new Error(`HTTP error! status: ${response.status}`);
              });
            }
            return response.json();
          })
          .then(json => {
            location.reload();
          })
          .catch((error) => {
            console.log('Error:', error);
          });
        });

      });

      // 카테고리 수정 및 삭제 버튼
      document.addEventListener('DOMContentLoaded', function() {
        var editCategoryBtn = document.querySelector('#update-category-btn');
        var deleteCategoryBtn = document.querySelector('#delete-category-btn');

        var updateButtonsVisible = false;
        var deleteButtonsVisible = false;

        // 수정 버튼
        if(editCategoryBtn) {
          editCategoryBtn.addEventListener('click', function() {
            updateButtonsVisible = !updateButtonsVisible;

            if (deleteButtonsVisible) {
              deleteButtonsVisible = false;
              deleteCategoryBtn.textContent = '삭제';
              toggleButtons('.delete-category-sub-btn', 'none');
            }

            editCategoryBtn.textContent = updateButtonsVisible ? '취소' : '수정';
            toggleButtons('.update-category-sub-btn', updateButtonsVisible ? 'block' : 'none');
          });
        }

        // 삭제 버튼
        if(deleteCategoryBtn) {
          deleteCategoryBtn.addEventListener('click', function() {
            deleteButtonsVisible = !deleteButtonsVisible;

            if (updateButtonsVisible) {
              updateButtonsVisible = false;
              editCategoryBtn.textContent = '수정';
              toggleButtons('.update-category-sub-btn', 'none');
            }

            deleteCategoryBtn.textContent = deleteButtonsVisible ? '취소' : '삭제';
            toggleButtons('.delete-category-sub-btn', deleteButtonsVisible ? 'block' : 'none');
          });
        }

        function toggleButtons(selector, displayStyle) {
          document.querySelectorAll(selector).forEach(function(button) {
            button.style.display = displayStyle;
          });
        }

        // 카테고리 삭제
        document.querySelectorAll('.delete-category-sub-btn').forEach(function(button) {
          button.addEventListener('click', function() {
            var categoryId = this.getAttribute('data-category-id');
            fetch('/category/' + categoryId + '/delete/', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
                'X-CSRFToken': '{{ csrf_token }}'
              },
            }).then(function() {
              location.reload();
            });
          });
        });

        // 카테고리 수정
        document.querySelectorAll('.update-category-sub-btn').forEach(function(button) {
          button.addEventListener('click', function() {
            var categoryId = this.getAttribute('data-category-id');

            const categoryInfo = currentUserCategories.find(function(category) {
              return category.pk == categoryId;
            });

            document.querySelector("#update-category-form").setAttribute("data-category-id", categoryId);

            // 모달에 정보 채우기
            document.querySelector('#update-category-is-public').value = categoryInfo.fields.is_public.toString();
            document.querySelector('#update-category-name').value = categoryInfo.fields.name;
            document.querySelector('#update-category-description').value = categoryInfo.fields.description;

            // 모달 표시
            var updateModal = new bootstrap.Modal(document.getElementById('update-create-modal'));
            updateModal.show();
          });
        });
      });

      // Category 모양 변경
      document.addEventListener('DOMContentLoaded', function() {
        const categoryButtons = document.getElementById('categoryButtons'); 
        const categoryCaretIcon = document.getElementById('category-caret-icon');

        categoryButtons.addEventListener('show.bs.collapse', function() {
          categoryCaretIcon.src = "{% static 'bootstrap-icons-1.10.5/caret-up-fill.svg' %}";
        });

        categoryButtons.addEventListener('hide.bs.collapse', function() { 
          categoryCaretIcon.src = "{% static 'bootstrap-icons-1.10.5/caret-down-fill.svg' %}";
        });
      });
    }
    
    </script>
</html>
